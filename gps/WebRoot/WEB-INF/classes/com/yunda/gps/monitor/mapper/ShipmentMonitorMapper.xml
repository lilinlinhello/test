<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yunda.gps.monitor.mapper.ShipmentMonitorMapper" >
  <resultMap id="BaseResultMap" type="com.yunda.gps.monitor.pojo.ShipmentMonitorPo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="shipment_id" property="shipmentId" jdbcType="CHAR" />
    <result column="line_id" property="lineId" jdbcType="VARCHAR" />
    <result column="line_name" property="lineName" jdbcType="VARCHAR" />
    <result column="place_id" property="placeId" jdbcType="INTEGER" />
    <result column="order_id" property="orderId" jdbcType="TINYINT" />
    <result column="plan_leave_time" property="planLeaveTime" jdbcType="TIMESTAMP" />
    <result column="plan_arrive_time" property="planArriveTime" jdbcType="TIMESTAMP" />
    <result column="real_leave_time" property="realLeaveTime" jdbcType="TIMESTAMP" />
    <result column="real_arrive_time" property="realArriveTime" jdbcType="TIMESTAMP" />
    <result column="gps_leave_time" property="gpsLeaveTime" jdbcType="TIMESTAMP" />
    <result column="gps_arrive_time" property="gpsArriveTime" jdbcType="TIMESTAMP" />
    <result column="license_card_id" property="licenseCardId" jdbcType="VARCHAR" />
    <result column="monitor_flag" property="monitorFlag" jdbcType="TINYINT" />
    <result column="shipment_flag" property="shipmentFlag" jdbcType="TINYINT" />
    <result column="mileage_flag" property="mileageFlag" jdbcType="TINYINT" />
    <result column="plan_line_id" property="planLineId" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <sql id="Base_Column_List" >
    id, shipment_id, line_id, line_name, place_id, order_id, plan_leave_time, plan_arrive_time, 
    real_leave_time, real_arrive_time, gps_leave_time, gps_arrive_time, license_card_id, 
    monitor_flag, shipment_flag, mileage_flag, plan_line_id, create_time
  </sql>
  
  
  <select id="pageQuery" resultMap="BaseResultMap" parameterType="com.yunda.gps.monitor.pojo.ShipmentMonitorVo" >
    SELECT
		a.id as id,
		a.shipment_id as shipmentId,
		a.place_id as placeId,
		a.order_id as orderId,
		DATE_FORMAT(		a.plan_leave_time,		'%Y-%c-%d %h:%i:%s'	) AS planLeaveTime,
		DATE_FORMAT(		a.plan_arrive_time,		'%Y-%c-%d %h:%i:%s'	) AS planArriveTime,
		DATE_FORMAT(		a.real_leave_time,		'%Y-%c-%d %h:%i:%s'	) AS realLeaveTime,
		DATE_FORMAT(		a.real_arrive_time,		'%Y-%c-%d %h:%i:%s'	) AS realArriveTime,
		DATE_FORMAT(		a.gps_leave_time,		'%Y-%c-%d %h:%i:%s'	) AS gpsLeaveTime,
		DATE_FORMAT(		a.gps_arrive_time,		'%Y-%c-%d %h:%i:%s'	) AS gpsArriveTime,
	
	
		b.line_id as lineId,
		b.line_name as lineName,
		b.license_card_id as licenseCardId,
		b.monitor_flag as monitorFlag,
		b.shipment_flag as shipmentFlag,
		b.mileage_flag as mileageFlag,
		b.plan_line_id as planLineId,
		DATE_FORMAT(		b.create_time,		'%Y-%c-%d %h:%i:%s'	) AS createTime,
		DATE_FORMAT(		b.update_time,		'%Y-%c-%d %h:%i:%s'	) AS updateTime
	FROM
		shipment_monitor a,shipment_monitor_main b 
	WHERE
		a.shipment_id = b.shipment_id

	<if test="realLeaveTimeMin != null and realLeaveTimeMin != ''">
		<![CDATA[
			and a.real_leave_time >= #{realLeaveTimeMin}
		]]>
	</if>
	<if test="realLeaveTimeMax != null and realLeaveTimeMax != ''">
		<![CDATA[
			and a.real_leave_time <= #{realLeaveTimeMax}
		]]>
	</if>
	<if test="realArriveTimeMin != null and realArriveTimeMin != ''">
		<![CDATA[
			and a.real_arrive_time >= #{realArriveTimeMin}
		]]>
	</if>
	<if test="realArriveTimeMax != null and realArriveTimeMax != ''">
		<![CDATA[
			and a.real_arrive_time <= #{realArriveTimeMax}
		]]>
	</if>
	
	<if test="shipmentId != null and shipmentId != ''"> and b.shipment_id = #{shipmentId}</if>
	<if test="lineId != null and lineId != ''"> and b.line_id = #{lineId}</if>
	<if test="lineName != null and lineName != ''"> and b.line_name like concat('%', #{lineName}, '%')</if>
	<if test="monitorFlag != null and monitorFlag != ''"> and b.monitor_flag = #{monitorFlag}</if>
	<if test="shipmentFlag != null and shipmentFlag != ''"> and b.shipment_flag = #{shipmentFlag}</if>
	<if test="mileageFlag != null and mileageFlag != ''"> and b.mileage_flag = #{mileageFlag}</if>
	
	
  </select>
  
  
  
</mapper>